# Example SEAD Reconciliation Configuration
# This file demonstrates reconciliation setup for common entity types

# Base URL of the OpenRefine reconciliation service
service_url: "http://localhost:8000"

# Entity-specific reconciliation specifications
entities:
  
  # Example: Site reconciliation with geographic properties
  site:
    # Optional: specify data source for reconciliation
    # - null/empty/same as entity name: use entity preview data (default)
    # - another entity name: use that entity's preview data
    # - dict with data_source/type/query: execute custom query
    source: null  # Use site entity preview data
    
    keys:
      - site_name  # Primary identifier
    
    property_mappings:
      # Map SEAD service property IDs to source column names
      latitude: site_latitude       # Geographic coordinates
      longitude: site_longitude
      country: country_name         # Location context
      national_id: national_site_id # Official identifier
      place_name: locality          # Additional location info
    
    remote:
      service_type: "site"  # Must match service defaultTypes
    
    auto_accept_threshold: 0.95  # Auto-accept â‰¥95% confidence
    review_threshold: 0.70       # Review 70-95% confidence
    
    mapping: []  # Auto-populated during reconciliation

  # Example: Taxon reconciliation using another entity's data
  taxon:
    # Use enriched taxon data from a temporary/helper entity
    source: "taxon_with_hierarchy"  # Entity with additional taxonomic fields
    
    keys:
      - species_name  # Primary species identifier
    
    property_mappings:
      genus: genus_col           # Taxonomic hierarchy
      family: family_col
      scientific_name: binomial  # Full scientific name
    
    remote:
      service_type: "taxon"
    
    auto_accept_threshold: 0.90
    review_threshold: 0.65
    
    mapping: []

  # Example: Using custom SQL query for reconciliation data
  site_with_coordinates:
    source:
      data_source: "arbodat_data"  # Data source name from main config
      type: sql
      query: |
        SELECT 
          Fustel AS site_name,
          EVNr AS national_site_identifier,
          rWert AS latitude,
          hWert AS longitude,
          Ort AS locality
        FROM Projekte
        WHERE rWert IS NOT NULL AND hWert IS NOT NULL
    
    keys:
      - site_name
    
    property_mappings:
      latitude: latitude
      longitude: longitude
      national_id: national_site_identifier
      place_name: locality
    
    remote:
      service_type: "site"
    
    auto_accept_threshold: 0.95
    review_threshold: 0.70
    
    mapping: []

  # Example: Bibliographic reference with structured identifiers
  bibliographic_reference:
    keys:
      - citation  # Full citation text
    
    property_mappings:
      doi: doi_column           # Digital Object Identifier
      title: ref_title
      year: publication_year
      authors: author_names
      isbn: isbn_number
    
    remote:
      service_type: "bibliographic_reference"
    
    auto_accept_threshold: 0.98  # Strict matching for references
    review_threshold: 0.85
    
    mapping: []

  # Example: Location/place reconciliation
  location:
    keys:
      - place_name
    
    property_mappings:
      place_name: location_name  # Alternative spellings
    
    remote:
      service_type: "location"
    
    auto_accept_threshold: 0.92
    review_threshold: 0.75
    
    mapping: []

  # Example: Country reconciliation (simple, no properties needed)
  country:
    keys:
      - country_name
    
    property_mappings: {}  # No additional properties
    
    remote:
      service_type: "country"
    
    auto_accept_threshold: 0.98  # High threshold for country names
    review_threshold: 0.90
    
    mapping: []

  # Example: Method with abbreviation
  method:
    keys:
      - method_name
    
    property_mappings:
      method_abbreviation: abbrev  # Method abbreviation
    
    remote:
      service_type: "method"
    
    auto_accept_threshold: 0.95
    review_threshold: 0.75
    
    mapping: []

  # Example: Entity with reconciliation disabled
  sample:
    keys:
      - sample_name
    
    property_mappings: {}
    
    remote:
      service_type: null  # Reconciliation disabled - no service type
    
    mapping: []
